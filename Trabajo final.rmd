---
title: "Ensamblaje De Novo de Transcritos con Trinity"
author: "Gustavo Tapia, Josue Cerecedo, Antonio Martinez"
date: "16 de marzo de 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

D

```{r hisat2}
#####################
#Abrir R desde la terminal con "open -a RStudio" para que herede el PATH
#####################


## Descarga y procesamiento fastqc de los datos de RNA-seq
#Working directory
working_directory <- getwd()
setwd(working_directory)

if (dir.exists("RNASeq_small/") == FALSE){
  print("Descargando archivos de RNASeq")
  system("wget http://tepeu.lcg.unam.mx/~compu2/cei/datos/RNASeq_small.tar")
  system("tar -xvf RNASeq_small.tar")
  system("gunzip *.fq.gz")
  
} else {
  print("La carpeta RNASeq ya existe")
}


#FastQC to all files
system("fastqc RNASeq_small/*.fq.gz")
#MultiQC
system("multiqc RNASeq_small")


## Descarga y construcciÃ³n del genoma de referencia
#Removi la direccion completa de las aplicaciones, deberian estar en el PATH


if (dir.exists("Genome/") == FALSE){
  print("Descargando archivos Genome")
  system("wget http://tepeu.lcg.unam.mx/~compu2/cei/datos/Genome.tar")
  system("tar -xvf Genome.tar")
  
} else {
  print("La carpeta Genome ya existe")
}


if (file.exists("Genome/Scaffolds.1.ht2") == FALSE){
  print("Descargando archivos Genome")
  system("hisat2-build Genome/Rhimi1_1_AssemblyScaffolds.fasta Scaffolds")
  system("hisat2-inspect -s Scaffolds")
  
} else {
  print("El Index del Genome ya existe")
}


```


Mapear las secuencias de RNA-Seq al genoma de referencia, para descartar las secuencias que vienen del hongo.

```{r}
#Obtener lista de archivos .fq.gz
lista_archivos_1 <- list.files(paste0(working_directory,"/RNASeq_small"),pattern = ".fq.gz")
#Obtener los primeros siete caracteres de los nombres de archivos y obtener los unicos
nombres_archivos_unicos <- unique(substr(lista_archivos_1, start = 1, stop = 7))
```

## Including Plots

You can also embed plots, for example:
```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
